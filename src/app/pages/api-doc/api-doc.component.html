<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
    <div>
      <h1 class="text-3xl font-bold text-white">API Documentation</h1>
      <p class="mt-2 text-sm text-white/60">
        Complete API reference for Employee Management System
      </p>
    </div>
    <div
      *ngIf="apiDoc()"
      class="flex items-center gap-2 rounded-lg border border-white/10 bg-white/5 px-4 py-2"
    >
      <span class="text-xs text-white/60">Version</span>
      <span class="text-sm font-semibold text-white">{{
        apiDoc()!.info.version
      }}</span>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading()" class="rounded-lg border border-white/10 bg-white/5 p-8 text-center">
    <p class="text-white/60">Loading API documentation...</p>
  </div>

  <!-- Error State -->
  <div
    *ngIf="error() && !loading()"
    class="rounded-lg border border-red-500/30 bg-red-500/10 p-4"
  >
    <p class="text-sm text-red-400">{{ error() }}</p>
    <button
      (click)="loadApiDocumentation()"
      class="mt-2 rounded-lg bg-red-500/20 px-4 py-2 text-sm text-red-400 transition-colors hover:bg-red-500/30"
    >
      Retry
    </button>
  </div>

  <!-- API Documentation Content -->
  <div *ngIf="apiDoc() && !loading()" class="space-y-6">
    <!-- API Info Card -->
    <div
      class="rounded-2xl border border-white/10 bg-white/5 p-6 backdrop-blur-xl"
    >
      <h2 class="mb-4 text-xl font-semibold text-white">
        {{ apiDoc()!.info.title }}
      </h2>
      <p class="mb-4 text-sm text-white/70">
        {{ apiDoc()!.info.description }}
      </p>
      <div class="flex flex-wrap items-center gap-4">
        <div class="flex items-center gap-2">
          <span class="text-xs text-white/60">Base URL:</span>
          <code
            class="rounded bg-white/10 px-2 py-1 text-xs text-white"
            >{{ apiDoc()!.info.baseUrl }}</code
          >
        </div>
        <div class="flex items-center gap-2">
          <span class="text-xs text-white/60">Version:</span>
          <span class="text-sm font-medium text-white">{{
            apiDoc()!.info.version
          }}</span>
        </div>
      </div>
    </div>

    <!-- Tabs for HTTP Methods -->
    <div
      class="rounded-[26px] border border-white/10 bg-white/5/80 p-6 shadow-[0_35px_90px_rgba(9,14,33,0.55)] backdrop-blur-xl"
    >
      <div class="mb-6 flex gap-2 border-b border-white/10">
        <button
          (click)="setActiveTab('GET')"
          [class]="
            activeTab() === 'GET'
              ? 'border-b-2 border-primary px-4 py-2 text-sm font-semibold text-primary'
              : 'px-4 py-2 text-sm font-medium text-white/60 transition-colors hover:text-white'
          "
        >
          GET
        </button>
        <button
          (click)="setActiveTab('POST')"
          [class]="
            activeTab() === 'POST'
              ? 'border-b-2 border-primary px-4 py-2 text-sm font-semibold text-primary'
              : 'px-4 py-2 text-sm font-medium text-white/60 transition-colors hover:text-white'
          "
        >
          POST
        </button>
        <button
          (click)="setActiveTab('PUT')"
          [class]="
            activeTab() === 'PUT'
              ? 'border-b-2 border-primary px-4 py-2 text-sm font-semibold text-primary'
              : 'px-4 py-2 text-sm font-medium text-white/60 transition-colors hover:text-white'
          "
        >
          PUT
        </button>
        <button
          (click)="setActiveTab('DELETE')"
          [class]="
            activeTab() === 'DELETE'
              ? 'border-b-2 border-primary px-4 py-2 text-sm font-semibold text-primary'
              : 'px-4 py-2 text-sm font-medium text-white/60 transition-colors hover:text-white'
          "
        >
          DELETE
        </button>
      </div>

      <!-- Category Filter -->
      <div class="mb-6 flex flex-wrap gap-2">
        <button
          (click)="setActiveCategory(null)"
          [class]="
            activeCategory() === null
              ? 'rounded-full border border-primary bg-primary/20 px-3 py-1 text-xs font-medium text-primary'
              : 'rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-medium text-white/60 transition-colors hover:border-white/20 hover:bg-white/10 hover:text-white'
          "
        >
          All Categories
        </button>
        <button
          *ngFor="let category of categories()"
          (click)="setActiveCategory(category)"
          [class]="
            activeCategory() === category
              ? 'rounded-full border border-primary bg-primary/20 px-3 py-1 text-xs font-medium text-primary'
              : 'rounded-full border border-white/10 bg-white/5 px-3 py-1 text-xs font-medium text-white/60 transition-colors hover:border-white/20 hover:bg-white/10 hover:text-white'
          "
        >
          {{ category }}
        </button>
      </div>

      <!-- Endpoints List -->
      <div class="space-y-4">
        <div
          *ngFor="let endpoint of filteredEndpoints()"
          class="rounded-xl border border-white/10 bg-white/5 p-6 transition-all hover:border-white/20 hover:bg-white/10"
        >
          <!-- Endpoint Header -->
          <div class="mb-4 flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between">
            <div class="flex-1">
              <div class="mb-2 flex items-center gap-3">
                <span
                  class="inline-flex rounded border px-2 py-1 text-xs font-semibold"
                  [class]="getMethodColor(endpoint.method)"
                >
                  {{ endpoint.method }}
                </span>
                <span
                  class="inline-flex rounded-full px-2 py-1 text-xs font-medium"
                  [class]="getCategoryColor(endpoint.category)"
                >
                  {{ endpoint.category }}
                </span>
              </div>
              <h3 class="mb-2 text-lg font-semibold text-white">
                {{ endpoint.path }}
              </h3>
              <p class="text-sm text-white/70">{{ endpoint.description }}</p>
            </div>
            <button
              (click)="copyToClipboard(endpoint.url)"
              class="rounded-lg border border-white/10 bg-white/5 px-3 py-2 text-xs text-white/60 transition-colors hover:border-white/20 hover:bg-white/10 hover:text-white"
              title="Copy URL"
            >
              ðŸ“‹ Copy URL
            </button>
          </div>

          <!-- URL -->
          <div class="mb-4 rounded-lg bg-white/5 p-3">
            <code class="text-sm text-white">{{ endpoint.url }}</code>
          </div>

          <!-- Parameters -->
          <div *ngIf="endpoint.parameters && endpoint.parameters.length > 0" class="mb-4">
            <h4 class="mb-2 text-sm font-semibold text-white">Parameters</h4>
            <div class="space-y-2">
              <div
                *ngFor="let param of endpoint.parameters"
                class="rounded-lg border border-white/10 bg-white/5 p-3"
              >
                <div class="flex items-center gap-2">
                  <code class="text-sm font-medium text-white">{{
                    param.name
                  }}</code>
                  <span
                    class="rounded px-1.5 py-0.5 text-xs"
                    [class]="
                      param.required
                        ? 'bg-red-500/20 text-red-400'
                        : 'bg-gray-500/20 text-gray-400'
                    "
                  >
                    {{ param.type }}
                  </span>
                  <span
                    *ngIf="param.required"
                    class="rounded bg-red-500/20 px-1.5 py-0.5 text-xs text-red-400"
                  >
                    Required
                  </span>
                </div>
                <p class="mt-1 text-xs text-white/60">{{ param.description }}</p>
              </div>
            </div>
          </div>

          <!-- Request Body -->
          <div *ngIf="endpoint.requestBody" class="mb-4">
            <h4 class="mb-2 text-sm font-semibold text-white">Request Body</h4>
            <div class="rounded-lg border border-white/10 bg-white/5 p-3">
              <div class="mb-2">
                <span class="text-xs text-white/60">Content-Type:</span>
                <code class="ml-2 text-xs text-white">{{
                  endpoint.requestBody.contentType
                }}</code>
              </div>
              <div>
                <span class="text-xs text-white/60">Schema:</span>
                <code class="ml-2 text-xs text-white">{{
                  formatSchema(endpoint.requestBody.schema)
                }}</code>
              </div>
            </div>
          </div>

          <!-- Response -->
          <div class="mb-4">
            <h4 class="mb-2 text-sm font-semibold text-white">Response</h4>
            <div class="rounded-lg border border-green-500/30 bg-green-500/10 p-3">
              <div class="mb-2">
                <span class="text-xs text-white/60">Status:</span>
                <span
                  class="ml-2 rounded bg-green-500/20 px-2 py-0.5 text-xs font-semibold text-green-400"
                >
                  {{ endpoint.response.status }}
                </span>
              </div>
              <div>
                <span class="text-xs text-white/60">Body:</span>
                <code class="ml-2 text-xs text-white">{{
                  formatSchema(endpoint.response.body)
                }}</code>
              </div>
            </div>
          </div>

          <!-- Error Responses -->
          <div *ngIf="endpoint.errorResponses && endpoint.errorResponses.length > 0">
            <h4 class="mb-2 text-sm font-semibold text-white">Error Responses</h4>
            <div class="space-y-2">
              <div
                *ngFor="let error of endpoint.errorResponses"
                class="rounded-lg border border-red-500/30 bg-red-500/10 p-3"
              >
                <div class="mb-2">
                  <span class="text-xs text-white/60">Status:</span>
                  <span
                    class="ml-2 rounded bg-red-500/20 px-2 py-0.5 text-xs font-semibold text-red-400"
                  >
                    {{ error.status }}
                  </span>
                </div>
                <div>
                  <span class="text-xs text-white/60">Body:</span>
                  <code class="ml-2 text-xs text-white">{{
                    formatSchema(error.body)
                  }}</code>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Empty State -->
        <div
          *ngIf="filteredEndpoints().length === 0"
          class="rounded-lg border border-dashed border-white/20 bg-white/5 p-8 text-center"
        >
          <p class="text-sm text-white/60">
            No endpoints found for the selected method and category.
          </p>
        </div>
      </div>
    </div>
  </div>
</div>

